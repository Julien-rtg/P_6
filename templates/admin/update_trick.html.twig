{% extends 'base.html.twig' %}

{% block content %}

    {{ form_start(form) }}

        <div class="photoTrickSpotlight">
            {% for photo in figure.photoFigures %}
                {% if photo.preview %}
                    <div id="containerPreviewImage">
                        <img id="previewImage" class="width100" src="/assets/img/{{photo.path}}">
                    </div>
                {% endif %}
            {% endfor %}
            <a class="mr-5" onclick="openModal('modalPreviewImage')"><i class="fa-solid fa-pen"></i></a>
            <a href=""><i class="fa-solid fa-trash"></i></a>
        </div>

        <div class="columns is-multiline width90Auto">
            {# je boucle sur les photos de mes figures #}
            {% for photo in figure.photoFigures %}
                <div class="photoTrick column is-2">
                    <img src="/assets/img/{{photo.path}}">
                </div>
                <a class="mr-5" onclick="openModal('modalPreviewImage{{loop.index-1}}')"><i class="fa-solid fa-pen"></i></a>
                <a href=""><i class="fa-solid fa-trash"></i></a>
            {% endfor %}

            {# je boucle sur les videos de mes figures #}
            {% for video in figure.videoFigures %}
                <div class="videoTrick column is-2">
                    <iframe src="{{video.path}}" title="YouTube video player" 
                        frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
                    </iframe>
                </div>
            {% endfor %}
        </div>

        <div class="description container mt-6">
            {{ form_widget(form.nom, {'attr' : {'class': 'input'}} ) }}
        </div>
        <div class="description container mt-3">
            {{ form_widget(form.description, {'attr' : {'class': 'textarea', 'placeholder' : 'Commentaire'}} ) }}
        </div>

        <div class="container mt-3">
            <div class="select width100">
                {{ form_widget(form.groupe_figure, {'attr' : {'class':'width100', 'placeholder' : 'Description'}} ) }}
            </div>
        </div>

        <div class="container">
            {{ form_row(form.save, { 'label': 'Save', 'attr' : {'class' : 'button'} }) }}
        </div>

        <div class="modal" id="modalPreviewImage">
            <div class="modal-background"></div>
            <div class="modal-card">
                <header class="modal-card-head">
                    <p class="modal-card-title">Modifier image Ã  la une</p>
                    <a class="delete" aria-label="close" onclick="closeModal('modalPreviewImage');"></a>
                </header>
                <section class="modal-card-body">
                    <div class="columns is-multiline">
                        {% for photo in figure.photoFigures %}
                            <div class="photoTrick column is-6">
                                <img class="cursor" src="/assets/img/{{photo.path}}" onclick="changePreviewImage('/assets/img/{{photo.path}}','{{photo.id}}', '{{photo.idFigure.id}}');">
                            </div>
                        {% endfor %}
                    </div>
                </section>
                <footer class="modal-card-foot">
                    <a class="button" onclick="closeModal('modalPreviewImage');">Retour</a>
                </footer>
            </div>
        </div>

        {# je boucle sur mes photos pour avoir le memes nombres de modals #}
        {% for photo in figure.photoFigures %}
            <div class="modal" id="modalPreviewImage{{loop.index-1}}">
                <div class="modal-background"></div>
                <div class="modal-card">
                    <header class="modal-card-head">
                        <p class="modal-card-title">Modifier image</p>
                        <a class="delete" aria-label="close"></a>
                    </header>
                    <section class="modal-card-body">
                        {{ form_widget(form.photoFigures[(loop.index)-1], {'attr' : {'class': 'input'}} ) }}
                    </section>
                    <footer class="modal-card-foot">
                        <a class="button is-success" onclick="closeModal('modalPreviewImage{{loop.index-1}}')">Valider</a>
                    </footer>
                </div>
            </div>
        {% endfor %}

    {{ form_end(form, {'render_rest': false}) }}

{% endblock %}
